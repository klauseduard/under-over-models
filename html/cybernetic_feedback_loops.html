<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Organizational Cybernetic Feedback Loops</title>
  <style>
    body {
      font-family: 'Arial', sans-serif;
      margin: 0;
      padding: 20px;
      display: flex;
      flex-direction: column;
      align-items: center;
      background-color: #f9f9f9;
    }
    
    h1 {
      margin-bottom: 24px;
      color: #333;
    }
    
    .container {
      display: flex;
      flex-direction: column;
      align-items: center;
      max-width: 800px;
      width: 100%;
    }
    
    .controls {
      display: flex;
      justify-content: center;
      margin-bottom: 24px;
      gap: 16px;
    }
    
    .btn {
      padding: 10px 20px;
      border: none;
      border-radius: 5px;
      font-weight: 600;
      cursor: pointer;
      transition: all 0.2s ease;
    }
    
    .btn-negative {
      background-color: #3498db;
      color: white;
    }
    
    .btn-negative.inactive {
      background-color: #e0e0e0;
      color: #666;
    }
    
    .btn-positive {
      background-color: #e74c3c;
      color: white;
    }
    
    .btn-positive.inactive {
      background-color: #e0e0e0;
      color: #666;
    }
    
    .btn-start {
      background-color: #2ecc71;
      color: white;
    }
    
    .btn-start:disabled {
      background-color: #ccc;
      cursor: not-allowed;
    }
    
    .btn-reset {
      background-color: #e74c3c;
      color: white;
    }
    
    .btn-reset:disabled {
      background-color: #ccc;
      cursor: not-allowed;
    }
    
    .explanation {
      text-align: center;
      margin-bottom: 20px;
      font-size: 18px;
      font-weight: 500;
    }
    
    .step-text {
      text-align: center;
      margin-bottom: 20px;
      font-size: 16px;
      min-height: 24px;
    }
    
    .diagram-container {
      position: relative;
      width: 700px;
      height: 400px;
      margin-bottom: 20px;
    }
    
    svg {
      width: 100%;
      height: 100%;
    }
    
    #svg-container {
      transition: background-color 0.5s ease;
    }
    
    .legend {
      margin-top: 30px;
      width: 100%;
      max-width: 600px;
    }
    
    .legend h2 {
      margin-bottom: 10px;
    }
    
    .legend p {
      line-height: 1.5;
      margin-bottom: 15px;
    }
    
    .legend ul {
      padding-left: 20px;
    }
    
    .legend li {
      margin-bottom: 5px;
    }
    
    /* SVG animation stylings */
    .system-component {
      transition: opacity 0.3s ease;
    }
    
    .connector-path {
      transition: opacity 0.3s ease;
    }

    .metric-bar {
      transition: height 0.5s ease, y 0.5s ease, fill 0.5s ease;
    }
    
    .metric-text {
      transition: fill 0.5s ease;
    }
  </style>
</head>
<body>
  <div class="container">
    <h1>Organizational Cybernetic Feedback Loops</h1>
    
    <div class="controls">
      <button id="btn-negative" class="btn btn-negative">Negative (Stabilizing) Loop</button>
      <button id="btn-positive" class="btn btn-positive inactive">Positive (Amplifying) Loop</button>
    </div>
    
    <div class="explanation" id="loop-explanation">
      Negative Feedback: Error-correcting, stabilizing process
    </div>
    
    <div class="step-text" id="step-text">
      Click 'Start Animation' to begin
    </div>
    
    <div class="diagram-container">
      <svg id="svg-container" viewBox="0 0 700 400">
        <!-- Background -->
        <rect x="0" y="0" width="700" height="400" fill="#edf7ff" rx="10" id="background-rect" />
        
        <!-- System components -->
        <g transform="translate(350, 200)">
          <!-- System -->
          <g id="system-component" class="system-component">
            <rect x="-100" y="-50" width="200" height="100" rx="10" fill="white" stroke="#3498db" stroke-width="3" id="system-rect" />
            <text x="0" y="0" text-anchor="middle" dominant-baseline="middle" font-size="18" font-weight="bold" fill="#3498db" id="system-text">
              System
            </text>
            <text x="0" y="25" text-anchor="middle" dominant-baseline="middle" font-size="14">
              Organization Performance
            </text>
          </g>
          
          <!-- Target -->
          <g id="target-component" class="system-component" transform="translate(0, -150)">
            <rect x="-80" y="-40" width="160" height="80" rx="10" fill="white" stroke="#3498db" stroke-width="3" id="target-rect" />
            <text x="0" y="-15" text-anchor="middle" dominant-baseline="middle" font-size="16" font-weight="bold" fill="#3498db" id="target-text">
              Target
            </text>
            <text x="0" y="15" text-anchor="middle" dominant-baseline="middle" font-size="14" fill="#3498db" id="target-value">
              50%
            </text>
          </g>
          
          <!-- Sensor -->
          <g id="sensor-component" class="system-component" transform="translate(-200, 0)">
            <rect x="-60" y="-40" width="120" height="80" rx="10" fill="white" stroke="#3498db" stroke-width="3" id="sensor-rect" />
            <text x="0" y="0" text-anchor="middle" dominant-baseline="middle" font-size="16" font-weight="bold" fill="#3498db" id="sensor-text">
              Sensor
            </text>
          </g>
          
          <!-- Action -->
          <g id="action-component" class="system-component" transform="translate(0, 150)">
            <rect x="-80" y="-40" width="160" height="80" rx="10" fill="white" stroke="#3498db" stroke-width="3" id="action-rect" />
            <text x="0" y="-15" text-anchor="middle" dominant-baseline="middle" font-size="16" font-weight="bold" fill="#3498db" id="action-title">
              Corrective Action
            </text>
            <text x="0" y="15" text-anchor="middle" dominant-baseline="middle" font-size="14" fill="#3498db" id="action-desc">
              Resources/Adjustment
            </text>
          </g>
          
          <!-- Connector paths -->
          <!-- System to Sensor -->
          <g id="sensor-path" class="connector-path">
            <path d="M -100,0 L -140,0" stroke="#2980b9" stroke-width="3" fill="none" marker-end="url(#arrowhead)" />
            <text x="-120" y="-10" text-anchor="middle" font-size="12" fill="#3498db">Feedback</text>
          </g>
          
          <!-- Sensor to Compare/Target (negative) -->
          <g id="compare-path" class="connector-path">
            <path d="M -200,-40 L -200,-150 L -80,-150" stroke="#2980b9" stroke-width="3" fill="none" marker-end="url(#arrowhead)" />
            <text x="-140" y="-155" text-anchor="middle" font-size="12" fill="#3498db">Compare</text>
          </g>
          
          <!-- Sensor to Amplify path (positive) - hidden initially -->
          <g id="amplify-path" class="connector-path" style="opacity: 0.3; display: none;">
            <path d="M -200,-40 L -200,-150 L -200,-150 Q -200,-200 -100,-200 L 0,-200 L 0,-90" stroke="#c0392b" stroke-width="3" fill="none" marker-end="url(#arrowhead)" />
            <text x="-100" y="-205" text-anchor="middle" font-size="12" fill="#e74c3c">Amplify</text>
          </g>
          
          <!-- Target to Action (negative) -->
          <g id="negative-action-path" class="connector-path">
            <path d="M 80,-150 L 200,-150 L 200,110 L 80,110" stroke="#2980b9" stroke-width="3" fill="none" marker-end="url(#arrowhead)" />
            <text x="160" y="-30" text-anchor="middle" font-size="12" fill="#3498db">Correct</text>
          </g>
          
          <!-- Positive action path (hidden initially) -->
          <g id="positive-action-path" class="connector-path" style="opacity: 0.3; display: none;">
            <path d="M -260,0 L -260,110 L -80,110" stroke="#c0392b" stroke-width="3" fill="none" marker-end="url(#arrowhead)" />
            <text x="-170" y="105" text-anchor="middle" font-size="12" fill="#e74c3c">Reinforce</text>
          </g>
          
          <!-- Action to System -->
          <g id="system-path" class="connector-path">
            <path d="M 0,110 L 0,50" stroke="#2980b9" stroke-width="3" fill="none" marker-end="url(#arrowhead)" />
            <text x="10" y="80" text-anchor="start" font-size="12" fill="#3498db" id="apply-text">Apply</text>
          </g>
          
          <!-- Define arrowhead marker -->
          <defs>
            <marker id="arrowhead" markerWidth="10" markerHeight="7" refX="9" refY="3.5" orient="auto">
              <polygon points="0 0, 10 3.5, 0 7" fill="#2980b9" id="arrowhead-poly" />
            </marker>
          </defs>
        </g>
        
        <!-- Metric visualization -->
        <g transform="translate(580, 100)">
          <rect x="-70" y="-90" width="140" height="180" rx="5" fill="white" stroke="#ccc" stroke-width="1" />
          <text x="0" y="-70" text-anchor="middle" font-size="14" font-weight="bold">Performance Metric</text>
          
          <!-- Target line -->
          <line x1="-50" y1="0" x2="50" y2="0" stroke="#888" stroke-width="2" stroke-dasharray="5,3" />
          <text x="60" y="0" text-anchor="start" font-size="12" fill="#888">Target (50%)</text>
          
          <!-- Current value bar -->
          <rect id="metric-bar"
            x="-30" 
            y="0" 
            width="60" 
            height="0" 
            fill="#3498db" 
            opacity="0.7"
            class="metric-bar"
          />
          
          <!-- Current value text -->
          <text id="metric-text" x="0" y="-45" text-anchor="middle" font-size="24" font-weight="bold" fill="#3498db" class="metric-text">
            50%
          </text>
          
          <!-- Scale -->
          <line x1="-40" y1="-50" x2="-40" y2="50" stroke="#ddd" stroke-width="1" />
          <text x="-45" y="-50" text-anchor="end" font-size="10" fill="#888">100%</text>
          <text x="-45" y="0" text-anchor="end" font-size="10" fill="#888">50%</text>
          <text x="-45" y="50" text-anchor="end" font-size="10" fill="#888">0%</text>
        </g>
      </svg>
    </div>
    
    <div class="controls">
      <button id="btn-start" class="btn btn-start">Start Animation</button>
      <button id="btn-reset" class="btn btn-reset" disabled>Reset</button>
    </div>
    
    <div class="legend" id="legend">
      <h2>About Negative Feedback Loops</h2>
      <p>
        Negative feedback loops are self-stabilizing mechanisms that correct deviations from a target state. They work to maintain equilibrium in a system by applying corrective action when sensors detect deviation from the desired target.
      </p>
      <h3>Organizational Examples:</h3>
      <ul id="examples-list">
        <li>Quality control systems that detect and fix defects</li>
        <li>Budget controls that adjust spending when exceeding targets</li>
        <li>Resource allocation based on performance gaps</li>
        <li>Staffing adjustments to maintain service levels</li>
      </ul>
    </div>
  </div>

  <script>
    // Configuration
    const negativeColors = {
      main: "#3498db", // Blue
      secondary: "#2ecc71", // Green
      background: "#edf7ff",
      arrow: "#2980b9"
    };
    
    const positiveColors = {
      main: "#e74c3c", // Red
      secondary: "#f39c12", // Orange
      background: "#fff5ec",
      arrow: "#c0392b"
    };
    
    // DOM elements
    const btnNegative = document.getElementById('btn-negative');
    const btnPositive = document.getElementById('btn-positive');
    const btnStart = document.getElementById('btn-start');
    const btnReset = document.getElementById('btn-reset');
    const stepText = document.getElementById('step-text');
    const loopExplanation = document.getElementById('loop-explanation');
    const legendTitle = document.querySelector('.legend h2');
    const legendDesc = document.querySelector('.legend p');
    const examplesList = document.getElementById('examples-list');
    
    // Animation elements
    const backgroundRect = document.getElementById('background-rect');
    const systemRect = document.getElementById('system-rect');
    const systemText = document.getElementById('system-text');
    const targetRect = document.getElementById('target-rect');
    const targetText = document.getElementById('target-text');
    const sensorRect = document.getElementById('sensor-rect');
    const sensorText = document.getElementById('sensor-text');
    const actionRect = document.getElementById('action-rect');
    const actionTitle = document.getElementById('action-title');
    const actionDesc = document.getElementById('action-desc');
    const applyText = document.getElementById('apply-text');
    const arrowheadPoly = document.getElementById('arrowhead-poly');
    const metricBar = document.getElementById('metric-bar');
    const metricText = document.getElementById('metric-text');
    
    // Path elements
    const sensorPath = document.getElementById('sensor-path');
    const comparePath = document.getElementById('compare-path');
    const amplifyPath = document.getElementById('amplify-path');
    const negativeActionPath = document.getElementById('negative-action-path');
    const positiveActionPath = document.getElementById('positive-action-path');
    const systemPath = document.getElementById('system-path');
    
    // State variables
    let loopType = 'negative';
    let playing = false;
    let step = 0;
    let metric = 50;
    let animationTimer = null;
    const targetValue = 50;
    const totalSteps = 6;
    const stepDuration = 2000; // 2 seconds per step
    
    // Initialize components opacity
    updateComponentOpacity();
    
    // Event listeners
    btnNegative.addEventListener('click', () => switchLoopType('negative'));
    btnPositive.addEventListener('click', () => switchLoopType('positive'));
    btnStart.addEventListener('click', startAnimation);
    btnReset.addEventListener('click', stopAnimation);
    
    // Switch between loop types
    function switchLoopType(type) {
      if (playing) return;
      
      loopType = type;
      
      // Update UI for selected loop type
      if (type === 'negative') {
        btnNegative.classList.remove('inactive');
        btnPositive.classList.add('inactive');
        
        // Show/hide paths
        comparePath.style.display = 'block';
        amplifyPath.style.display = 'none';
        negativeActionPath.style.display = 'block';
        positiveActionPath.style.display = 'none';
        
        // Update colors
        updateColors(negativeColors);
        
        // Update descriptions
        actionTitle.textContent = 'Corrective Action';
        actionDesc.textContent = 'Resources/Adjustment';
        loopExplanation.textContent = 'Negative Feedback: Error-correcting, stabilizing process';
        
        // Update legend
        legendTitle.textContent = 'About Negative Feedback Loops';
        legendDesc.textContent = 'Negative feedback loops are self-stabilizing mechanisms that correct deviations from a target state. They work to maintain equilibrium in a system by applying corrective action when sensors detect deviation from the desired target.';
        examplesList.innerHTML = `
          <li>Quality control systems that detect and fix defects</li>
          <li>Budget controls that adjust spending when exceeding targets</li>
          <li>Resource allocation based on performance gaps</li>
          <li>Staffing adjustments to maintain service levels</li>
        `;
        
      } else {
        btnPositive.classList.remove('inactive');
        btnNegative.classList.add('inactive');
        
        // Show/hide paths
        comparePath.style.display = 'none';
        amplifyPath.style.display = 'block';
        negativeActionPath.style.display = 'none';
        positiveActionPath.style.display = 'block';
        
        // Update colors
        updateColors(positiveColors);
        
        // Update descriptions
        actionTitle.textContent = 'Amplifying Action';
        actionDesc.textContent = 'Reinforcement/Investment';
        loopExplanation.textContent = 'Positive Feedback: Reinforcing, amplifying process';
        
        // Update legend
        legendTitle.textContent = 'About Positive Feedback Loops';
        legendDesc.textContent = 'Positive feedback loops are self-reinforcing mechanisms that amplify changes in a system. They can lead to exponential growth or decline, and while sometimes beneficial for growth strategies, they may require external controls to prevent runaway effects.';
        examplesList.innerHTML = `
          <li>Network effects in platform businesses</li>
          <li>Viral marketing campaigns</li>
          <li>Employee recognition programs that reward success</li>
          <li>Market share momentum that attracts more customers</li>
        `;
      }
      
      // Reset metric visualization
      updateMetricVisualization(50);
    }
    
    // Update colors based on loop type
    function updateColors(colors) {
      backgroundRect.setAttribute('fill', colors.background);
      systemRect.setAttribute('stroke', colors.main);
      systemText.setAttribute('fill', colors.main);
      targetRect.setAttribute('stroke', colors.main);
      targetText.setAttribute('fill', colors.main);
      sensorRect.setAttribute('stroke', colors.main);
      sensorText.setAttribute('fill', colors.main);
      actionRect.setAttribute('stroke', colors.main);
      actionTitle.setAttribute('fill', colors.main);
      actionDesc.setAttribute('fill', colors.main);
      applyText.setAttribute('fill', colors.main);
      arrowheadPoly.setAttribute('fill', colors.arrow);
      
      // Update all paths
      const paths = document.querySelectorAll('path');
      paths.forEach(path => {
        path.setAttribute('stroke', colors.arrow);
      });
      
      // Update all text elements in paths
      const pathTexts = Array.from(document.querySelectorAll('.connector-path text'));
      pathTexts.forEach(text => {
        text.setAttribute('fill', colors.main);
      });
    }
    
    // Start animation
    function startAnimation() {
      playing = true;
      step = 0;
      
      // Set initial metric value based on loop type
      metric = loopType === 'negative' ? 30 : 55;
      updateMetricVisualization(metric);
      
      // Update button states
      btnStart.disabled = true;
      btnReset.disabled = false;
      
      // Start animation loop
      animationStep();
    }
    
    // Stop animation
    function stopAnimation() {
      playing = false;
      step = 0;
      
      // Reset metric
      metric = 50;
      updateMetricVisualization(metric);
      
      // Reset text
      stepText.textContent = "Click 'Start Animation' to begin";
      
      // Reset component opacity
      updateComponentOpacity();
      
      // Update button states
      btnStart.disabled = false;
      btnReset.disabled = true;
      
      // Clear any pending animations
      clearTimeout(animationTimer);
    }
    
    // Animation step
    function animationStep() {
      if (!playing) return;
      
      // Handle metric changes based on loop type and step
      if (loopType === 'negative') {
        // Negative feedback loop logic
        if (step === 0) metric = 30; // Initial deviation below target
        if (step === 3) metric = 40; // Start correction
        if (step === 4) metric = 45; // Continue correction
        if (step === 5) metric = 49; // Almost at target
      } else {
        // Positive feedback loop logic
        if (step === 0) metric = 55; // Initial small increase
        if (step === 3) metric = 62; // First amplification
        if (step === 4) metric = 72; // Continued amplification
        if (step === 5) metric = 85; // Runaway growth
      }
      
      // Update metric visualization
      updateMetricVisualization(metric);
      
      // Update step text
      updateStepText();
      
      // Update component opacity
      updateComponentOpacity();
      
      // Highlight appropriate path
      highlightPath();
      
      // Move to next step or reset
      if (step >= totalSteps) {
        animationTimer = setTimeout(() => {
          stopAnimation();
        }, stepDuration);
      } else {
        step++;
        animationTimer = setTimeout(animationStep, stepDuration);
      }
    }
    
    // Update metric visualization
    function updateMetricVisualization(value) {
      const difference = Math.abs(value - targetValue);
      const barHeight = difference * 2; // Scale for visibility
      
      if (value < targetValue) {
        // Below target
        metricBar.setAttribute('y', 0);
        metricBar.setAttribute('height', barHeight);
        metricBar.setAttribute('fill', negativeColors.main);
        metricText.setAttribute('fill', negativeColors.main);
      } else {
        // Above target
        metricBar.setAttribute('y', -barHeight);
        metricBar.setAttribute('height', barHeight);
        metricBar.setAttribute('fill', positiveColors.main);
        metricText.setAttribute('fill', positiveColors.main);
      }
      
      metricText.textContent = value + '%';
    }
    
    // Update step text
    function updateStepText() {
      if (!playing) {
        stepText.textContent = "Click 'Start Animation' to begin";
        return;
      }
      
      if (loopType === 'negative') {
        switch(step) {
          case 0:
            stepText.textContent = "Performance has deviated below target";
            break;
          case 1:
            stepText.textContent = "1. Sensor detects performance below target";
            break;
          case 2:
            stepText.textContent = "2. Deviation is compared against target value";
            break;
          case 3:
            stepText.textContent = "3. Corrective action is initiated to address gap";
            break;
          case 4:
            stepText.textContent = "4. System responds to correction";
            break;
          case 5:
            stepText.textContent = "5. Performance approaches target (stabilization)";
            break;
          default:
            stepText.textContent = "";
        }
      } else {
        switch(step) {
          case 0:
            stepText.textContent = "Performance has increased slightly";
            break;
          case 1:
            stepText.textContent = "1. Sensor detects slight increase in performance";
            break;
          case 2:
            stepText.textContent = "2. Change is amplified through reinforcement";
            break;
          case 3:
            stepText.textContent = "3. System responds with accelerated growth";
            break;
          case 4:
            stepText.textContent = "4. Further amplification occurs";
            break;
          case 5:
            stepText.textContent = "5. Exponential growth continues (potential runaway)";
            break;
          default:
            stepText.textContent = "";
        }
      }
      
      // Set text color based on loop type
      stepText.style.color = loopType === 'negative' ? negativeColors.main : positiveColors.main;
    }
    
    // Update component opacity based on step
    function updateComponentOpacity() {
      const allComponents = document.querySelectorAll('.system-component');
      const allPaths = document.querySelectorAll('.connector-path');
      
      // Reset all components to semi-transparent
      allComponents.forEach(component => {
        component.style.opacity = playing ? 0.3 : 1;
      });
      
      // Reset all paths to semi-transparent
      allPaths.forEach(path => {
        path.style.opacity = playing ? 0.3 : 1;
      });
      
      if (!playing) return;
      
      // Highlight components based on current step
      if (loopType === 'negative') {
        if (step === 0 || step === 4 || step === 5) {
          document.getElementById('system-component').style.opacity = 1;
        } else if (step === 1) {
          document.getElementById('sensor-component').style.opacity = 1;
        } else if (step === 2) {
          document.getElementById('target-component').style.opacity = 1;
        } else if (step === 3) {
          document.getElementById('action-component').style.opacity = 1;
          document.getElementById('target-component').style.opacity = 1;
        }
      } else {
        if (step === 0 || step === 4 || step === 5) {
          document.getElementById('system-component').style.opacity = 1;
        } else if (step === 1) {
          document.getElementById('sensor-component').style.opacity = 1;
        } else if (step === 2) {
          document.getElementById('sensor-component').style.opacity = 1;
        } else if (step === 3) {
          document.getElementById('action-component').style.opacity = 1;
        }
      }
    }
    
    // Highlight current path
    function highlightPath() {
      // Reset all paths
      const allPaths = document.querySelectorAll('.connector-path');
      allPaths.forEach(path => {
        path.style.opacity = 0.3;
      });
      
      // Highlight path based on current step
      if (loopType === 'negative') {
        if (step === 1) {
          sensorPath.style.opacity = 1;
        } else if (step === 2) {
          comparePath.style.opacity = 1;
        } else if (step === 3) {
          negativeActionPath.style.opacity = 1;
        } else if (step === 4 || step === 5) {
          systemPath.style.opacity = 1;
        }
      } else {
        if (step === 1) {
          sensorPath.style.opacity = 1;
        } else if (step === 2) {
          amplifyPath.style.opacity = 1;
        } else if (step === 3 || step === 4 || step === 5) {
          systemPath.style.opacity = 1;
          positiveActionPath.style.opacity = 1;
        }
      }
    }
  </script>
</body>
</html>
